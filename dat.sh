#!/bin/bash

# Not Running
notrunning(){
    read -p "
[1] Start Docker
[2] Exit
-> " notr

    case $notr in
        1)
            systemctl start docker
            menu
            ;;
        2)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            echo -e "Bye :)"
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            ;;
        *)
            echo -e "\nInvalid Option >:("
            notrunning
            ;;
    esac
}


# Manage Containers
menuopt2(){
    read -p "
[1] Show Containers
[2] Container Shell
[3] Copy a File (Host -> Container)
[4] Copy a File (Container -> Host)
[5] Rename a container
[6] Create an image out of a container
[7] Stop a container
[8] Delete a Container
[9] Delete ALL stoped containers
[10] Exit
[11] Menu
-> " opt2

    case $opt2 in
        1)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menuopt2
            ;;
        2)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker start $contid
            docker exec -it $contid bash
            ;;
        3)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            read -p "Host Path: " hpath
            read -p "Container Path: " cpath
            docker cp $hpath $contid:$cpath
            menuopt2
            ;;
        4) 
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            read -p "Container Path: " cpath
            read -p "Host Path: " hpath
            docker cp $contid:$cpath $hpath 
            menuopt2
            ;;
        5)  
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "Container OLD name: " contondname
            read -p "Container NEW name: " contnewname
            docker rename $contondname:$contnewname  
            menuopt2
            ;;
        6)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker commit $contid
            menuopt2
            ;;
        7)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker stop $contid
            menuopt2
            ;;
        8)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker rm -f $contid
            menuopt2
            ;;
        9)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker container prune
            menuopt2
            ;;
        10)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            echo -e "Bye :)"
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            ;;
        11)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menu
            ;;
        *)
            echo -e "\nInvalid Option >:("
            menuopt2
            ;;
    esac
}


#Manage Images
menuopt3(){
    read -p "
[1] Show all Images
[2] Delete an Image
[3] Download an Image
[4] Build an image from a Dockerfile
[5] Save an image to a .tar file
[6] Load an image from a .tar file
[7] Exit
[8] Menu
-> " opt3

    case $opt3 in
        1)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker images
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menuopt3
            ;;
        2)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker images
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "Image ID: " imgid
            docker rmi $imgid
            menuopt3
            ;;
        3)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            read -p "Image Name: " imgname
            docker pull $imgname
            menuopt3
            ;;
        4) 
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            read -p "Docker File Path: " dfpath
            docker build $dfpath
            menuopt3
            ;;
        5)  
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            read -p "Image ID: " imgid
            read -p ".tar File Path: " tarpath
            docker save $imgid > $tarpath
            menuopt3
            ;;
        6)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            read -p ".tar File Path: " tarpath
            docker load -i $tarpath
            menuopt3
            ;;
        7)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            echo -e "Bye :)"
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            ;;
        8)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menu
            ;;
        *)
            echo -e "\nInvalid Option >:("
            menuopt3
            ;;
    esac
}


#Info & Stats
menuopt4(){
    read -p "
[1] Show the Logs of a Container
[2] Show Stats of Running Containers
[3] Show Processes of Container
[4] Show Docker Version
[5] Show Mapped Ports of a Container
[6] Exit
[7] Menu
-> " opt4

    case $opt4 in
        1)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker logs $contid
            menuopt4
            ;;
        2)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker stats
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menuopt4
            ;;
        3)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker top $contid
            menuopt4
            ;;
        4) 
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker version
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menuopt4
            ;;
        5)  
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker ps -a
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            read -p "CONTAINER ID: " contid
            docker port $contid
            menuopt4
            ;;
        6)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            echo -e "Bye :)"
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            ;;
        7)
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menu
            ;;
        *)
            echo -e "\nInvalid Option >:("
            menuopt4
            ;;
    esac
}


#Menu
menu(){
    echo -e "\n+-----------------------------------------------------------------------------------------------------+\n"
    read -p "[1] Run a new container
[2] Manage Containers
[3] Manage Images
[4] Info & Stats
[5] Stop Docker
[6] Exit
[7] The Ultimate Docker Cheat Sheet
-> " menuopt

    case $menuopt in

        1)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            docker images
            echo -e "+-----------------------------------------------------------------------------------------------------+
Set a name: --name <name>
Map a port: -p <HostPort>:<ContainerPort>
Start in background: -d
Set the Entrypoint: -it 

Example: docker run -p <HostPort>:<ContainerPort> --name=<name> -dit <entrypoint> <Image>
Example: docker run -p 80:80 --name=F4Container -dit /bin/bash archlinux
+-----------------------------------------------------------------------------------------------------+"
            menu
            ;;
        2)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            menuopt2
            ;;
        3)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            menuopt3
            ;;
        4) 
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            menuopt4
            ;;
        5)  
            systemctl stop docker
            ;;
        6)  
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            echo -e "Bye :)"
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            ;;
        7)
            echo -e "\n+-----------------------------------------------------------------------------------------------------+"
            echo -e "|                          https://dockerlabs.collabnix.com/docker/cheatsheet/                        |"
            echo -e "+-----------------------------------------------------------------------------------------------------+"
            menu
            ;;
        *)
            echo -e "\nInvalid Option >:("
            menu
            ;;
    esac
}


echo -e "
🄳🄾🄲🄺🄴🅁 🄰🄳🄼🄸🄽🄸🅂🅃🅁🄰🅃🄸🄾🄽 🅃🄾🄾🄻
by: 𝔽𝟜 (https://beacons.ai/f4_zzz) 
"
#Main
systemctl is-active --quiet docker

if [ $? -eq 0 ]; then
    echo -e "\n+-----------------------------------------------------------------------------------------------------+"
    echo -e "|                                      Docker is Running                                              |"
    echo -e "+-----------------------------------------------------------------------------------------------------+"
    menu
else 
    echo -e "\n+-----------------------------------------------------------------------------------------------------+"
    echo -e "|                                      Docker is NOT Running                                          |"
    echo -e "+-----------------------------------------------------------------------------------------------------+"
    notrunning
fi

